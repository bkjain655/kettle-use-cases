from datetime import date
import folium, streamlit as st
from geojson_data.geojson_rental_car_us_states import rental_car_states_geodata

def get_filtered_rentals(start_date: str = None, end_date: str = None) -> dict:
    """Filter rentals based on start and end dates."""
    if not start_date or not end_date:  # If no date filters provided, return all data
        filtered_data = rental_car_states_geodata.copy()
    else:
        filtered_data = {}
        for state in rental_car_states_geodata:
            if (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]), int(start_date[5:7]) - 1, int(start_date[-2:])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]) - 1, int(end_date[-2:]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]), int(start_date[5:7]) - 1, int(start_date[-2:])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]), int(end_date[-2:]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 1, int(start_date[5:7]) - 1, int(start_date[-2:])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 2, int(start_date[5:7]) - 1, int(start_date[-2:])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7]) - 1, int(start_date[-2:])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(int(end_date[:4]), int(end_date[5:7]))) or (rental_car_states_geodata[state]['startDate'] >= date(int(start_date[:4]) - 3, int(start_date[5:7])) and rental_car_states_geodata[state]['endDate'] <= date(